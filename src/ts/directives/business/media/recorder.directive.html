<!-- illustration -->
<div ng-class="{'d-none': !ctrl.showMenu}">
    <img class="img-fluid" skin-src="/img/illustrations/recorder-audio.svg" width="100" height="100" alt="recorder">
</div>

<!-- audio button -->
<div ng-class="{ 'd-none': !ctrl.showMenu || !ctrl.isAudioCompatible }">
    <a id="btnAudioRecorder" class="btn-circle" href="#" i18n-title="embed.audio.title"
            ng-click="ctrl.switchAudioRecord()">
        <i class="fas fa-microphone"></i>
    </a>
</div>

<!-- video button -->
<div ng-class="{ 'd-none': !ctrl.showMenu || !ctrl.isVideoCompatible }">
    <a id="btnVideoRecorder" class="btn-circle" href="#"
            ng-click="ctrl.switchVideoRecord()">
        <i class="fas fa-video"></i>
    </a>
</div>

<div ng-if="!ctrl.isAudioCompatible && !ctrl.isVideoCompatible">
	<p><i18n>recorder.not.supported</i18n></p>
</div>

<!-- audio recorder -->
<div ng-if="ctrl.hasPermission" ng-class="{ 'd-none': ctrl.showMenu || ctrl.isVideo || !ctrl.isAudioCompatible }">
    <div class="record-timer">
        <i class="fas fa-microphone"></i>
        [[ctrl.time()]]
    </div>
    <input type="text" class="form-control" i18n-placeholder="title" ng-model="ctrl.recorder.title" />
    
    <div class="record-controls">
        <button type="button" class="btn btn-circle"
                ng-click="ctrl.switchAudioRecord()"
                ng-disabled="ctrl.isEncoding || ctrl.isUploading">
            <i class="fas" ng-class="{'fa-microphone': !ctrl.isRecording, 'fa-pause': ctrl.isRecording}"></i>
            <span class="label" ng-if="!ctrl.isRecording"><i18n>embed.resume</i18n></span>
            <span class="label" ng-if="ctrl.isRecording"><i18n>embed.suspend</i18n></span>
        </button>

        <button type="button" class="btn btn-circle"
                ng-click="ctrl.switchPlay()"
                ng-disabled="ctrl.isRecording || ctrl.isEncoding || ctrl.isUploading">
            <i class="fas" ng-class="ctrl.isPlaying ? 'fa-pause' : 'fa-play'"></i>
            <span class="label" ng-if="!ctrl.isPlaying"><i18n>embed.play</i18n></span>
            <span class="label" ng-if="ctrl.isPlaying"><i18n>embed.pause</i18n></span>
        </button>

        <button type="button" class="btn btn-circle"
                ng-click="ctrl.recorder.flush()"
                ng-disabled="ctrl.isRecording || ctrl.isEncoding || ctrl.isUploading">
            <i class="fas fa-redo-alt"></i>
            <span class="label"><i18n>embed.redo</i18n></span>
        </button>

        <button type="button" class="btn btn-circle"
                ng-click="ctrl.saveRecord()"
                ng-disabled="ctrl.isRecording || ctrl.isEncoding || ctrl.isUploading">
            <i ng-class="ctrl.getSaveBtnClass()"></i>
            <span class="label"><i18n>embed.save</i18n></span>
        </button>
    </div>
</div>

<!-- video recorder -->
<div ng-if="ctrl.hasPermission && !(ctrl.showMenu || ctrl.isAudio) && ctrl.isVideoCompatible"
        navigation-guard="true"
        guard-root="videoCapturedGuard">
    <div class="record-timer">
        <i class="fas fa-video"></i>
        &nbsp;[[ctrl.msToTime(ctrl.recorder.elapsedTime)]]/[[ctrl.msToTime(ctrl.recordMaxTime)]]
    </div>
    <div>
        <select class="form-select mb-2"
            ng-if="ctrl.videoInputDevices.length > 1"
            ng-options="vid as vid.label for vid in ctrl.videoInputDevices"
            ng-disabled="ctrl.isRecording"
            ng-model="ctrl.selectedVid" ng-change="ctrl.switchVideo(ctrl.selectedVid.deviceId)" >
        </select>
    </div>
    <div id="recorderWidgetVideoPlayer"><!--The video player will be appended here--></div>
    <div>
        <input type="text" class="form-control" i18n-placeholder="title" ng-model="ctrl.recorder.title" />
    </div>
    <div class="record-controls" custom-guard="recordGuard">
        <button type="button" class="btn btn-circle"
                ng-click="ctrl.switchVideoRecord()"
                ng-disabled="ctrl.isEncoding || ctrl.isUploading">
            <i class="fas" ng-class="{'fa-stop': ctrl.isRecording, 'fa-redo-alt': !ctrl.isRecording}"></i>
            <span class="label">[[ctrl.isRecording ? 'embed.stop' : 'embed.redo' | i18n]]</span>
        </button>

        <button type="button" class="btn btn-circle"
                ng-click="ctrl.switchPlay()"
                ng-disabled="ctrl.isRecording || ctrl.isEncoding || ctrl.isUploading">
            <i class="fas" ng-class="{'fa-pause': ctrl.isPlaying, 'fa-play': !ctrl.isPlaying}"></i>
            <span class="label">[[ctrl.isPlaying ? 'embed.pause' : 'embed.play' | i18n]]</span>
        </button>

        <button type="button" class="btn btn-circle"
                ng-click="ctrl.saveRecord()"
                ng-disabled="ctrl.isRecording || ctrl.isEncoding || ctrl.isUploading">
            <i ng-class="ctrl.getSaveBtnClass()"></i>
            <span class="label"><i18n>embed.save</i18n></span>
        </button>
    </div>
</div>